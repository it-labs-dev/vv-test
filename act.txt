@startuml
start
:Получение запроса на закрытие счета;
if(счет уже заблокирован?) then (Да)
  #pink :вернуть ошибку;
  stop
else (Нет)
:Установка блокировки на счет;
:Запрос в МС Клиенты;
if(Запрос был обработан с ошибкой?) then (Да)
  :Снять блокировку;
  #pink :вернуть ошибку;
  stop
else (Нет)
  :Запрос в МС Договора;
  if(Запрос был обработан с ошибкой?) then (Да)
    :Снять блокировку;
    #pink :вернуть ошибку;
    stop
  else (Нет)
    :Закрыть счет;
    :Снять блокировку;
    #green :Вернуть сообщение об успехе;
    stop
  endif
endif
endif
@enduml
